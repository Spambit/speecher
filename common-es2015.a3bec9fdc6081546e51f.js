(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{EFyh:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var i=o("YMfE"),n=o("XNiG"),r=o("fXoL");let s=(()=>{class e{constructor(){this.login$=new n.a,this.loadGoogleApi()}initClient({scope:e="",apiKey:t="",clientId:o="",discoveryDocs:i=([]=[""])}){return gapi?gapi.client.init({apiKey:t,clientId:o,scope:e,discoveryDocs:i}).then(()=>{this.googleAuth=gapi.auth2.getAuthInstance(),this.googleAuth.isSignedIn.listen(e=>this.updateSigninStatus(e))},e=>Promise.reject(e)):Promise.reject("Google Api not available.")}updateSigninStatus(e){console.log(`Logged in : ${e}`),this.login$.next(e)}loadGoogleApi(){const e=document.createElement("script");e.addEventListener("load",()=>this.googleApiDidLoad()),e.setAttribute("src","https://apis.google.com/js/api.js"),document.body.appendChild(e)}isLoggedIn({forScope:e=""}){return!!this.googleAuth&&this.googleAuth.currentUser.get().hasGrantedScopes(e)}getUserInfo(){if(!this.googleAuth||!this.googleAuth.currentUser)return;const e=this.googleAuth.currentUser.get().getBasicProfile();return{avatar:e.getImageUrl(),name:e.getName(),email:e.getEmail(),shortName:e.getFamilyName()}}googleApiDidLoad(){gapi.load("client:auth2",()=>{console.log("Google auth loaded.")})}throwDeferedError(e){i.b(()=>{this.login$.error(e)})}login({scope:e="",key:t="",clientId:o="",discoveryDocs:i=([]=[""])}){return this.initClient({scope:e,apiKey:t,clientId:o,discoveryDocs:i}).then(e=>{if(this.googleAuth.isSignedIn.get())this.login$.next(!0);else{const e=new gapi.auth2.SigninOptionsBuilder;e.setPrompt("select_account"),e.setScope("profile").setScope("email"),this.googleAuth.signIn(e).catch(e=>{this.throwDeferedError(e)})}}).catch(e=>{this.login$.error(e)}),this.login$}logout(){return this.googleAuth?this.googleAuth.isSignedIn.get()?this.googleAuth.signOut().catch(e=>{this.throwDeferedError("logout failed")}):i.b(()=>this.login$.next(!1)):this.throwDeferedError("Google Auth was not loaded."),this.login$}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},YMfE:function(e,t,o){"use strict";function i(e,t){const o=new e,i=Object.keys(t);for(const n of i)o[n]=t[n];return o}o.d(t,"a",(function(){return i})),o.d(t,"b",(function(){return n}));const n=e=>{window.setTimeout(e,0)}},tLnd:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var i=o("SxV6");var n=o("fXoL"),r=o("EFyh");let s=(()=>{class e{constructor(e){this.loginService=e,this.loginOptions={key:"AIzaSyDoqtuscz4Pp_xuR9nYO10O-PsouptHmuA",clientId:"814240394039-953g9k1ovucedj8u0aghsj5ofsii5jut.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.appdata",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}}createBaseFolder(e){return this.loadGoogleDrive().then(()=>this.createFolderInternal({name:e}))}isLoggedIn(){return this.loginService.isLoggedIn({forScope:this.loginOptions.scope})}findFile({id:e}){return this.loadGoogleDrive().then(()=>gapi.client.drive.files.list({q:`'${e}' in parents`,fields:"nextPageToken, files(id, name)",spaces:"drive"}).then(e=>200===e.status).catch(()=>!1))}login(){return this.loadGoogleDrive()}loadGoogleDrive(){return new Promise((e,t)=>{this.loginService.isLoggedIn({forScope:this.loginOptions.scope})?this.loadApi().then(e).catch(t):this.loginService.login(this.loginOptions).pipe(Object(i.a)()).subscribe(o=>{o?this.loadApi().then(e).catch(t):t()})})}loadApi(){return gapi&&gapi.client.drive?Promise.resolve():gapi.client.load("drive","v3")}createFolderInternal({name:e="Speecher-Data-Folder"}){const t={name:e,mimeType:"application/vnd.google-apps.folder",folderColorRgb:"#007bff"};return console.log("Logged in and trying to create folder in drive."),new Promise((e,o)=>{gapi.client.drive.files.create({resource:t,fields:"id"}).then(t=>{switch(t.status){case 200:const i=t.result;console.log("Created file or folder Id: ",i.id),e({id:i.id});break;default:console.log("Error creating the file or folder, "+t),o(t)}})})}logout(){return this.loginService.logout()}createFile({name:e,withContent:t,folderId:o}){return this.createFileWithJSONContent({name:e,data:JSON.stringify(t),folderId:o})}createFileWithJSONContent({name:e,data:t,folderId:o}){return new Promise((i,n)=>{const r="\r\n---------speecher-boundary\r\n",s=r+"Content-Type: application/json\r\n\r\n"+JSON.stringify({name:e,mimeType:"application/json",parents:[o]})+r+"Content-Type: application/json\r\n\r\n"+t+"\r\n---------speecher-boundary--";gapi.client.request({path:"/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/related; boundary="-------speecher-boundary"'},body:s}).execute((e,t)=>{if(200!==t.status)return n();i()})})}}return e.\u0275fac=function(t){return new(t||e)(n.Zb(r.a))},e.\u0275prov=n.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);
//# sourceMappingURL=common-es2015.a3bec9fdc6081546e51f.js.map